# 《智能健康饮食管理平台 - 产品需求文档 (PRD)》
> 🚀 项目名称：SmartNutri (智能膳食管家)

## 1\. 项目背景与目标

打造一个集**身体数据监控、饮食记录、AI 智能分析、个性化推荐**于一体的健康管理平台。通过微服务架构支撑高并发，利用 AI 大模型提供私人营养师服务。

-----

## 2\. 核心业务功能架构 (Feature List)

除了你提出的基础功能，我增加了一些**高价值（亮点）功能**，用 `[亮点]` 标记：

### 模块一：用户健康档案 (User Profile & Metrics)

* **基础档案**：年龄、性别、身高、当前体重、目标体重。
* **身体指标计算**：
    * 自动计算 **BMI**。
    * **[亮点] TDEE (每日总能量消耗) 计算**：结合用户的“运动活跃度”（久坐、轻度运动、重度运动），计算用户每天真正需要的热量（不仅仅是基础代谢）。
    * **宏观营养素目标**：自动规划碳水、蛋白质、脂肪的摄入比例（例如：增肌模式 vs 减脂模式）。

### 模块二：智能饮食记录 (Smart Tracking)

* **日历/时间轴视图**：按早餐、午餐、晚餐、加餐进行记录。
* **食物库检索**：支持模糊搜索（如“红烧肉”），后端从数据库返回热量及营养素。
* **[亮点] AI 拍照识菜 (Spring AI + 多模态模型)**：用户上传一张食物照片，AI 自动识别食物名称并预估卡路里（这是非常加分的技术点）。
* **自定义食物**：用户可录入特定食物。

### 模块三：数据可视化仪表盘 (Dashboard)

* **今日概览**：仪表盘显示“今日已摄入 vs 目标剩余”，包括热量缺口。
* **趋势分析**：
    * 体重变化折线图（近7天/30天）。
    * 热量摄入柱状图。
    * 三大营养素占比饼图。

### 模块四：AI 营养师 (AI Consultant)

* **智能问答 (RAG 增强)**：
    * 用户问：“我今天还可以吃什么？”
    * AI 结合用户**今日剩余热量**和**营养缺口**进行回答（e.g., “你今天蛋白质摄入不足，建议晚餐吃煎鸡胸肉，约150g”）。
* **[亮点] 膳食生成器**：一键生成“减脂周计划”，并自动加入日历。

### 模块五：健康社区与激励 (Gamification)

* **打卡系统**：连续记录奖励。
* **食谱分享**：用户分享健康餐，其他人可“一键复制”到自己的日历。

-----

## 3\. 技术架构方案 (Tech Stack)

你选用的技术栈非常主流且硬核，以下是具体的架构落地建议：

### 后端架构 (Java Spring体系)

* **Spring Cloud Alibaba / Netflix**:
    * **Gateway**: 统一网关，鉴权、限流。
    * **Nacos**: 注册中心与配置中心。
    * **OpenFeign**: 微服务间调用。
* **Spring AI**: 对接大模型（OpenAI/Azure/智谱AI/通义千问），实现对话和图像识别。
* **MySQL**: 存储用户信息、食物基础库（建议预导入常见食物数据）、业务记录。
* **Redis**:
    * 缓存高频查询的“食物库”数据。
    * 缓存用户每日的实时统计数据（避免频繁查库）。
* **Kafka**:
    * **异步解耦**：用户记录饮食后，发送消息到 Kafka，异步触发“周报计算”、“成就达成判断”、“AI 建议更新”等非实时任务，提升接口响应速度。

### 前端架构 (Vue Ecosystem)

* **核心框架**: Vue 3 (Composition API) + TypeScript + Vite。
* **UI 组件库**: **Element Plus** (后台管理风格) 或 **Vant UI** (如果是做移动端 H5 风格)。
* **图表库**: **ECharts** (必选，用于画体重折线图和营养雷达图)。
* **状态管理**: Pinia。

-----

## 4\. 数据库设计概览 (核心表)

为了支撑上述业务，你需要设计以下核心实体：

| 表名             | 描述     | 关键字段                                                    |
|:---------------|:-------|:--------------------------------------------------------|
| `users`        | 用户表    | id, height, weight, activity\_level, tdee\_goal         |
| `food_library` | 食物基础库  | id, name, calorie(per 100g), protein, fat, carbs        |
| `daily_record` | 每日记录主表 | id, user\_id, date, total\_cal, status                  |
| `record_item`  | 每餐明细   | id, record\_id, meal\_type (早/中/晚), food\_id, weight(g) |
| `weight_log`   | 体重记录表  | id, user\_id, date, weight\_value                       |

-----

## 5\. AI 功能实现逻辑 (Spring AI 特别说明)

这是你项目的核心亮点，建议按以下逻辑实现：

1.  **Prompt Engineering (提示词工程)**:

    * 不只是简单的调用 API。你需要构建一个包含用户上下文的 Prompt。
    * *Example Code Logic:*

    <!-- end list -->

    ```java
    String systemPrompt = "你是一位专业的营养师。用户当前身高" + height + 
                          "，体重" + weight + "，今日已摄入热量" + currentCal + 
                          "，距离目标还差" + remainCal + "。请根据这些数据推荐晚餐。";
    // 调用 Spring AI ChatClient
    ```

2.  **RAG (检索增强生成)**:

    * 如果你的食物库里有特殊的“健康食谱”，可以将这些食谱向量化存入向量数据库（如 PGVector 或 Redis Vector），AI 回答时先检索本地食谱，再生成回答。

-----

## 6\. 项目开发阶段规划 (Milestones)

作为产品经理，我建议你分三步走，避免一开始摊子铺太大：

* **阶段一 (MVP - 核心闭环)**:
    * 完成用户注册、基础代谢计算。
    * 实现手动搜索食物、记录饮食、数据库存取。
    * Vue 前端展示基础列表。
* **阶段二 (数据可视化 & 架构优化)**:
    * 引入 Redis 缓存食物库。
    * 引入 ECharts 展示体重趋势和热量仪表盘。
    * 接入 Kafka 异步处理统计逻辑。
* **阶段三 (AI 赋能)**:
    * 接入 Spring AI。
    * 实现 AI 对话和（可选的）图片识别。

-----

### 💡 针对前端 Vue 的特别建议

既然你不太了解前端，推荐你使用 **Vue Admin 模板** 或者 **Uniapp (Vue语法)**。

1.  **如果是做网页版**：直接用 [Vue-Element-Admin](https://github.com/PanJiaChen/vue-element-admin) 的简化版或者是 [Element Plus 的官方模板](https://element-plus.org/)。
2.  **交互逻辑**：
    * 前端负责展示日历，点击某一天 -\> 调用后端 API 获取当天的 `daily_record`。
    * 前端负责计算简单的实时反馈（如进度条颜色变化），复杂的计算交给后端。

-----

**我能为你做的下一步：**

这就相当于是项目的一份**高层设计文档**。为了让你能直接动手写代码，你希望我先帮你生成 **SQL 数据库建表语句**，还是先帮你写一个 **Spring AI 接入大模型的简单 Demo 代码**？

## SmartNutri (智能膳食管家)

| 模块     | 功能                 | 完成度 |
|--------|--------------------|-----|
| 用户健康管理 | 登录                 | 100 |
| 用户健康管理 | 注册                 | 100 |
| 用户健康管理 | 基础档案               | 0   |
| 用户健康管理 | 身体指标计算             | 0   |
| 智能饮食记录 | 日历/时间轴视图           | 0   |
| 智能饮食记录 | 食物库检索              | 0   |
| 智能饮食记录 | AI拍照识别             | 0   |
| 数据可视化  | 今日概览（今日摄入 vs 目标剩余） | 0   |
| 数据可视化  | 趋势分析               | 0   |
| AI营养师  | 智能问答（RAG增强）        | 0   |
| AI营养师  | 膳食生成器              | 0   |
| 心理评测   |                    |     |
